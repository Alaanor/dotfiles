#!/bin/bash

if pidof wl-screenrec > /dev/null; then
  kill -INT $(pidof wl-screenrec)
  notify-send 'Screen recording done'
  dragon-drag-and-drop --and-exit "$(ls -Art ~/media/screencapture/*.mp4 | tail -n 1)"
else
  time=$(date +%F-%T)
  mkdir -p ~/media/screencapture
  region=$(slurp)
  [ -z "$region" ] && exit 1
  notify-send 'Screen recording starting'
  wl-screenrec -g "$region" -b "3 MB" --audio -f ~/media/screencapture/recording-$time.mp4
fi